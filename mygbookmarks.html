<!doctype html>

<html lang="tr">

<head>

<meta charset="utf-8">

<meta name="viewport" content="width=device-width,initial-scale=1">

<title>My Bookmarks v1.5</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">

<style>

:root{ --bg:#f6faff; --card:#fff; --muted:#667085; --accent:#00a3ff; font-family:'Inter',sans-serif; }

html,body{margin:0;height:100%;background:var(--bg);color:#0b1220;}

.app{display:grid;grid-template-columns:280px 1fr;height:100vh;}

.sidebar{ background:linear-gradient(180deg,#ffffff,rgba(255,255,255,0.9)); border-right:1px solid rgba(0,0,0,0.05); padding:20px; display:flex;flex-direction:column;gap:16px; position: relative; }

#versionInfo {

Â  Â  position: absolute; top: 10px; left: 10px;

Â  Â  background: #eef7ff; color: #007acc; padding: 3px 8px;

Â  Â  border-radius: 8px; font-size: 12px; font-weight: 600; z-index: 10;

}

.brand{display:flex;align-items:center;gap:12px; padding-top: 24px;} /* Added padding-top to make space for version */

.logo{ width:48px;height:48px;border-radius:50%; background:conic-gradient(from 180deg,#00a3ff,#00ffd0,#f0ff00,#ff7c7c,#00a3ff); display:flex;align-items:center;justify-content:center; font-weight:800;color:#022;overflow:hidden; }

.logo img{width:100%;height:100%;border-radius:50%;object-fit:cover;}

h1{font-size:17px;margin:0;}

#sidebarSubtitleContainer{ display: flex; align-items: center; justify-content: space-between; font-size: 12px; color: var(--muted); margin-top: 4px; }

#miniSignOutBtn { background: #fdeeee; color: #c53939; border:none; border-radius: 6px; padding: 2px 8px; font-size: 11px; font-weight: 600; cursor: pointer; transition: background .2s; }

#miniSignOutBtn:hover { background: #f9dcdc; }

.categories{flex:1;overflow:auto;padding-top:6px; display:flex; flex-direction:column; gap:4px;}

.category{ display:flex;align-items:center;gap:12px;padding:10px;border-radius:10px; cursor:pointer;user-select:none;transition: background .2s, opacity .2s; position:relative; }

.category.dragging{ opacity: 0.5; background: rgba(0,163,255,0.2); }

.category:hover{background:rgba(0,163,255,0.08);}

.category.active{background:rgba(0,163,255,0.12);}

.cat-icon{width:36px;height:36px;border-radius:8px; background:linear-gradient(180deg,#fff,#f3faff); display:flex;align-items:center;justify-content:center;font-weight:700;}

.cat-name{font-weight:600;flex:1;pointer-events: none;}

.main{ display:flex;flex-direction:column;height:100%;overflow:hidden; background:linear-gradient(180deg,#ffffff,#f9fcff); padding:24px; }

.header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;}

.header-title{font-size:20px;font-weight:800;}

#viewControls { display: none; flex-direction: row; gap: 8px; }

#viewControls button { padding: 6px 12px; font-size: 14px; }

.view-btn.active { background: var(--accent); color: white; }

.bookmark-list{flex:1;overflow:auto;display:flex;flex-direction:column;gap:10px;}

.card{ display:flex;align-items:center;gap:12px;background:var(--card); padding:10px;border-radius:12px;border:1px solid rgba(0,0,0,0.05); cursor:grab;transition:transform .1s; }

.card .fav{width:46px;height:46px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-weight:700; overflow:hidden;}

.card .meta{flex:1;min-width:0;}

.card .meta .title{font-weight:700;}

.card .meta .url{font-size:12px;color:var(--muted);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}

.card .actions{display:flex;gap:6px;}

.icon-btn{width:32px;height:32px;border-radius:8px;display:grid;place-items:center; border:1px solid rgba(0,0,0,0.05);cursor:pointer; background: #fff;}

.icon-btn:hover{background:#f0f0f0;}

.delete-cat, .edit-cat{ display:none; }

.category:hover .delete-cat, .category:hover .edit-cat{ display:grid; }

#homeBtn { display: flex; align-items: center; justify-content: center; gap: 8px; font-weight: 600; font-size: 15px; }

#homeBtn svg { width: 22px; height: 22px; }

.home-grid, .category-grid{ display:grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap:18px; }

.home-tile, .category-tile{ background:var(--card);border-radius:16px;padding:16px;text-align:center; box-shadow:0 6px 16px rgba(0,0,0,0.04); transition:transform .2s;cursor:pointer; text-decoration: none; color: inherit;}

.home-tile:hover, .category-tile:hover{transform:translateY(-3px);}

.home-tile img, .category-tile img{width:48px;height:48px;border-radius:12px;margin-bottom:8px; object-fit:cover;}

.home-tile .title, .category-tile .title{font-weight:600;font-size:14px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%;}

.modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(8,15,28,0.35);z-index:100;}

.modal.active{display:flex;}

.modal-card{ width:400px;background:var(--card);padding:20px;border-radius:14px; box-shadow:0 20px 40px rgba(0,0,0,0.15); }

label{font-size:13px;color:var(--muted);display:block;margin-top:10px;}

input[type=text], input[type=number], textarea, select{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(0,0,0,0.1);box-sizing:border-box; margin-top:4px;}

.modal-actions{display:flex;justify-content:flex-end;gap:8px;margin-top:12px;}

.btn{padding:8px 12px;border-radius:10px;background:#f4f7fa;border:1px solid rgba(0,0,0,0.05);cursor:pointer;}

.btn:hover{background:#e8eef3;}

.switch{display:flex;align-items:center;gap:8px;margin-top:12px; user-select:none;}

</style>

</head>

<body>

<div class="app">

Â  <aside class="sidebar" id="sidebar">

Â  Â  <div id="versionInfo">v1.5</div>

Â  Â  <div class="brand">

Â  Â  Â  <div class="logo" id="userLogo">Y</div>

Â  Â  Â  <div>

Â  Â  Â  Â  <h1 id="sidebarTitle">My Bookmarks</h1>

Â  Â  Â  Â  <div id="sidebarSubtitleContainer" style="display: none;">

Â  Â  Â  Â  Â  Â  <span id="sidebarSubtitle"></span>

Â  Â  Â  Â  Â  Â  <button id="miniSignOutBtn">Sign Out</button>

Â  Â  Â  Â  </div>

Â  Â  Â  </div>

Â  Â  </div>

Â  Â  <button class="btn" id="loginBtn">Sign in with Google</button>

Â  Â  <hr style="border:none; border-top:1px solid #eee; margin: 8px 0;">

Â  Â  <button class="btn" id="homeBtn">

Â  Â  Â  Â  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"></path></svg>

Â  Â  Â  Â  Home

Â  Â  </button>

Â  Â  <button class="btn" id="addCategoryBtn" style="display:none;">+ Add Category</button>

Â  Â  <div class="categories" id="categories"></div>

Â  </aside>



Â  <main class="main" id="main">

Â  Â  <div class="header">Â 

Â  Â  Â  <div class="header-title" id="pageTitle">Home</div>

Â  Â  Â  <div id="viewControls">

Â  Â  Â  Â  <button class="btn view-btn active" id="listViewBtn">List</button>

Â  Â  Â  Â  <button class="btn view-btn" id="cardViewBtn">Card</button>

Â  Â  Â  </div>

Â  Â  </div>

Â  Â  <div id="contentArea"></div>

Â  </main>

</div>



<!-- MODALS -->

<div class="modal" id="modal">

Â  <div class="modal-card">

Â  Â  <h3 id="modalTitle">Add/Edit Bookmark</h3>

Â  Â  <label for="mTitle">Title</label><input id="mTitle" type="text">

Â  Â  <label for="mUrl">URL</label><input id="mUrl" type="text">

Â  Â  <label for="mCategory">Category</label><select id="mCategory"></select>

Â  Â  <label for="mIcon">Icon URL (optional)</label><input id="mIcon" type="text">

Â  Â  <div class="switch"><input type="checkbox" id="mShowHome"><label for="mShowHome">Show on Home</label></div>

Â  Â  <div class="modal-actions">

Â  Â  Â  <button class="btn" id="cancelModal">Cancel</button>

Â  Â  Â  <button class="btn" id="saveModal">Save</button>

Â  Â  </div>

Â  </div>

</div>



<div class="modal" id="modalCategory">

Â  <div class="modal-card">

Â  Â  <h3>Add Category</h3>

Â  Â  <label for="cTitle">Category Name</label><input id="cTitle" type="text">

Â  Â  <div class="modal-actions">

Â  Â  Â  <button class="btn" id="cancelCategory">Cancel</button>

Â  Â  Â  <button class="btn" id="saveCategory">Save</button>

Â  Â  </div>

Â  </div>

</div>



<div class="modal" id="modalCategoryEdit">

Â  <div class="modal-card">

Â  Â  <h3>Edit Category</h3>

Â  Â  <label for="ceTitle">Category Name</label><input id="ceTitle" type="text">

Â  Â  <label for="ceOrder">Order (lower first)</label><input id="ceOrder" type="number" min="0">

Â  Â  <div class="modal-actions">

Â  Â  Â  <button class="btn" id="cancelCategoryEdit">Cancel</button>

Â  Â  Â  <button class="btn" id="saveCategoryEdit">Save</button>

Â  Â  </div>

Â  </div>

</div>



<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";

import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";



const firebaseConfig = {

Â  Â  apiKey: "AIzaSyBZ5oi1Vb-cNFQIk04rKMDwLJWVx06DfmI", // LÃ¼tfen kendi Firebase config bilgilerinizle deÄŸiÅŸtirin

Â  Â  authDomain: "my-g-bookmarks.firebaseapp.com",

Â  Â  projectId: "my-g-bookmarks",

Â  Â  storageBucket: "my-g-bookmarks.firebasestorage.app",

Â  Â  messagingSenderId: "702837130313",

Â  Â  appId: "1:702837130313:web:bb7e64d33a772ed3d1eb98",

Â  Â  measurementId: "G-WZVPMS2XY4"

};



const app = initializeApp(firebaseConfig);

const db = getFirestore(app);

const auth = getAuth();



// --- STATE MANAGEMENT ---

let BOOKMARKS = [];

let currentUser = null;

let currentView = 'home'; // 'home' or a category ID

let viewMode = 'list'; // 'list' or 'card'

let editingState = { bookmarkId: null, categoryId: null };



const $ = (selector) => document.querySelector(selector);



// --- CORE APP LOGIC ---

function sortCategories() {

Â  Â  BOOKMARKS.sort((a, b) => (a.order ?? Infinity) - (b.order ?? Infinity));

}



function renderApp() {

Â  Â  sortCategories();

Â  Â  renderCategories();

Â  Â  if (currentView === 'home') {

Â  Â  Â  Â  renderHome();

Â  Â  } else {

Â  Â  Â  Â  renderCategory(currentView);

Â  Â  }

}



async function handleDataChange() {

Â  Â  await saveBookmarks();

Â  Â  renderApp();

}



// --- AUTHENTICATION ---

onAuthStateChanged(auth, async user => {

Â  Â  currentUser = user;

Â  Â  if (user) {

Â  Â  Â  Â  $('#sidebarTitle').textContent = user.displayName || 'Bookmarks';

Â  Â  Â  Â  $('#sidebarSubtitle').textContent = user.email;

Â  Â  Â  Â  $('#sidebarSubtitleContainer').style.display = 'flex';

Â  Â  Â  Â  $('#userLogo').innerHTML = user.photoURL ? `<img src="${user.photoURL}" alt="User">` : (user.displayName || 'U').charAt(0);

Â  Â  Â  Â  $('#loginBtn').style.display = 'none';

Â  Â  Â  Â  $('#addCategoryBtn').style.display = 'block';

Â  Â  Â  Â Â 

Â  Â  Â  Â  const snap = await getDoc(doc(db, "bookmarks", currentUser.uid));

Â  Â  Â  Â  BOOKMARKS = snap.exists() ? snap.data().categories || [] : [];

Â  Â  Â  Â  // Assign orders if missing and fix showHome

Â  Â  Â  Â  let hasOrders = BOOKMARKS.some(c => c.order !== undefined);

Â  Â  Â  Â  if (!hasOrders) {

Â  Â  Â  Â  Â  Â  BOOKMARKS.forEach((cat, i) => { cat.order = i; });

Â  Â  Â  Â  }

Â  Â  Â  Â  BOOKMARKS = BOOKMARKS.map(cat => ({

Â  Â  Â  Â  Â  Â  ...cat,

Â  Â  Â  Â  Â  Â  items: (cat.items || []).map(item => ({

Â  Â  Â  Â  Â  Â  Â  Â  ...item,

Â  Â  Â  Â  Â  Â  Â  Â  showHome: item.showHome !== undefined ? !!item.showHome : false

Â  Â  Â  Â  Â  Â  }))

Â  Â  Â  Â  }));

Â  Â  Â  Â  currentView = 'home';

Â  Â  Â  Â  renderApp();

Â  Â  } else {

Â  Â  Â  Â  $('#sidebarTitle').textContent = 'My Bookmarks';

Â  Â  Â  Â  $('#sidebarSubtitleContainer').style.display = 'none';

Â  Â  Â  Â  $('#userLogo').textContent = 'Y';

Â  Â  Â  Â  $('#loginBtn').style.display = 'block';

Â  Â  Â  Â  $('#addCategoryBtn').style.display = 'none';

Â  Â  Â  Â  BOOKMARKS = [];

Â  Â  Â  Â  currentView = 'home';

Â  Â  Â  Â  renderApp();

Â  Â  Â  Â  $('#contentArea').innerHTML = "<div style='padding:20px; color:var(--muted)'>Please sign in.</div>";

Â  Â  }

});



// --- DATA PERSISTENCE ---

async function saveBookmarks() {

Â  Â  if (!currentUser) return;



Â  Â  // Kaydetmeden Ã¶nce veriyi temizle

Â  Â  const cleanedBookmarks = BOOKMARKS.map(cat => {

Â  Â  Â  Â  const cleanedCat = { ...cat };

Â  Â  Â  Â  // Kategori Ã¶ÄŸelerini temizle

Â  Â  Â  Â  cleanedCat.items = (cat.items || []).map(item => {

Â  Â  Â  Â  Â  Â  const cleanedItem = {};

Â  Â  Â  Â  Â  Â  for (const key in item) {

Â  Â  Â  Â  Â  Â  Â  Â  // undefined olmayan tÃ¼m alanlarÄ± kopyala

Â  Â  Â  Â  Â  Â  Â  Â  if (item[key] !== undefined) {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  cleanedItem[key] = item[key];

Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  return cleanedItem;

Â  Â  Â  Â  });



Â  Â  Â  Â  // Kategori alanlarÄ±nÄ± temizle (e.g. order)

Â  Â  Â  Â  for (const key in cleanedCat) {

Â  Â  Â  Â  Â  Â  if (cleanedCat[key] === undefined) {

Â  Â  Â  Â  Â  Â  Â  Â  delete cleanedCat[key];

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  }

Â  Â  Â  Â  return cleanedCat;

Â  Â  });

Â  Â  Â  Â Â 

Â  Â  try {

Â  Â  Â  Â  await setDoc(doc(db, "bookmarks", currentUser.uid), { categories: cleanedBookmarks }); // TemizlenmiÅŸ veriyi kaydet

Â  Â  Â  Â  console.log('Data saved successfully');

Â  Â  } catch (error) {

Â  Â  Â  Â  console.error('Error saving data: ', error);

Â  Â  Â  Â  alert('Failed to save data: ' + error.message);

Â  Â  }

}



// --- UI RENDERING FUNCTIONS ---

function renderCategories() {

Â  Â  const categoriesEl = $('#categories');

Â  Â  categoriesEl.innerHTML = '';

Â  Â  BOOKMARKS.forEach(cat => {

Â  Â  Â  Â  const el = document.createElement('div');

Â  Â  Â  Â  el.className = 'category' + (cat.id === currentView ? ' active' : '');

Â  Â  Â  Â  el.dataset.id = cat.id;

Â  Â  Â  Â  el.innerHTML = `<div class="cat-icon">${cat.title.charAt(0).toUpperCase()}</div><div class="cat-name">${cat.title}</div><button class="icon-btn edit-cat">ğŸ–Šï¸</button><div class="icon-btn delete-cat">ğŸ—‘ï¸</div>`;

Â  Â  Â  Â  categoriesEl.appendChild(el);

Â  Â  });

}



function renderHome() {

Â  Â  $('#pageTitle').textContent = 'Home';

Â  Â  $('#viewControls').style.display = 'none';

Â  Â  const homeItems = BOOKMARKS.flatMap(c => (c.items || []).filter(i => i.showHome));

Â  Â  const contentArea = $('#contentArea');

Â  Â  contentArea.innerHTML = '';



Â  Â  if (homeItems.length === 0) {

Â  Â  Â  Â  contentArea.innerHTML = "<div style='padding:20px; color:var(--muted)'>No bookmarks added to Home yet.</div>";

Â  Â  Â  Â  return;

Â  Â  }

Â  Â  const grid = document.createElement('div');

Â  Â  grid.className = 'home-grid';

Â  Â  homeItems.forEach(item => {

Â  Â  Â  Â  let hostname = '';

Â  Â  Â  Â  try {

Â  Â  Â  Â  Â  Â  hostname = new URL(item.url).hostname;

Â  Â  Â  Â  } catch (e) {

Â  Â  Â  Â  Â  Â  // Invalid URL, skip favicon

Â  Â  Â  Â  }

Â  Â  Â  Â  const iconSrc = item.icon || (hostname ? `https://www.google.com/s2/favicons?domain=${hostname}&sz=64` : '');

Â  Â  Â  Â  const fallbackSrc = hostname ? `https://t1.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=http://${hostname}&size=64` : '';

Â  Â  Â  Â  const tile = document.createElement('a');

Â  Â  Â  Â  tile.className = 'home-tile';

Â  Â  Â  Â  tile.href = item.url;

Â  Â  Â  Â  tile.target = '_blank';

Â  Â  Â  Â  tile.innerHTML = `<img src="${iconSrc}" alt="" onerror="if(this.src !== '${fallbackSrc}') this.src='${fallbackSrc}'; else this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDgiIGhlaWdodD0iNDgiIHZpZXdCb3g9IjAgMCA0OCA0OCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSIyNCIgY3k9IjI0IiByPSIyNCIgZmlsbD0iI2ZmZiIvPjx0ZXh0IHg9IjI0IiB5PSIyOSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE0IiBmaWxsPSIjOTk5Ij48L3RleHQ+PC9zdmc+';"><div class='title'>${item.title}</div>`;

Â  Â  Â  Â  grid.appendChild(tile);

Â  Â  });

Â  Â  contentArea.appendChild(grid);

}



function renderCategory(catId) {

Â  Â  const cat = BOOKMARKS.find(c => c.id === catId);

Â  Â  if (!cat) { currentView = 'home'; renderApp(); return; }



Â  Â  $('#pageTitle').textContent = cat.title;

Â  Â  $('#viewControls').style.display = 'flex';

Â  Â  updateViewButtons();



Â  Â  const contentArea = $('#contentArea');

Â  Â  contentArea.innerHTML = '';



Â  Â  const items = cat.items || [];

Â  Â  if (items.length === 0) {

Â  Â  Â  Â  contentArea.innerHTML = "<div style='padding:20px; color:var(--muted)'>This category is empty.</div>";

Â  Â  Â  Â  const addBtn = document.createElement('button');

Â  Â  Â  Â  addBtn.textContent = '+ Add Bookmark';

Â  Â  Â  Â  addBtn.className = 'btn';

Â  Â  Â  Â  addBtn.style.marginTop = '20px';

Â  Â  Â  Â  contentArea.appendChild(addBtn);

Â  Â  Â  Â  return;

Â  Â  }



Â  Â  if (viewMode === 'card') {

Â  Â  Â  Â  const grid = document.createElement('div');

Â  Â  Â  Â  grid.className = 'category-grid';

Â  Â  Â  Â  items.forEach(item => {

Â  Â  Â  Â  Â  Â  let hostname = '';

Â  Â  Â  Â  Â  Â  try {

Â  Â  Â  Â  Â  Â  Â  Â  hostname = new URL(item.url).hostname;

Â  Â  Â  Â  Â  Â  } catch (e) {

Â  Â  Â  Â  Â  Â  Â  Â  // Invalid URL

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  const iconSrc = item.icon || (hostname ? `https://www.google.com/s2/favicons?domain=${hostname}&sz=64` : '');

Â  Â  Â  Â  Â  Â  const fallbackSrc = hostname ? `https://t1.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=http://${hostname}&size=64` : '';

Â  Â  Â  Â  Â  Â  const tile = document.createElement('a');

Â  Â  Â  Â  Â  Â  tile.className = 'category-tile';

Â  Â  Â  Â  Â  Â  tile.href = item.url;

Â  Â  Â  Â  Â  Â  tile.target = '_blank';

Â  Â  Â  Â  Â  Â  tile.innerHTML = `<img src="${iconSrc}" alt="" onerror="if(this.src !== '${fallbackSrc}') this.src='${fallbackSrc}'; else this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDgiIGhlaWdodD0iNDgiIHZpZXdCb3g9IjAgMCA0OCA0OCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSIyNCIgY3k9IjI0IiByPSIyNCIgZmlsbD0iI2ZmZiIvPjx0ZXh0IHg9IjI0IiB5PSIyOSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE0IiBmaWxsPSIjOTk5Ij48L3RleHQ+PC9zdmc+';"><div class='title'>${item.title}</div>`;

Â  Â  Â  Â  Â  Â  grid.appendChild(tile);

Â  Â  Â  Â  });

Â  Â  Â  Â  contentArea.appendChild(grid);

Â  Â  } else {
Â  Â  Â  Â  const list = document.createElement('div');
Â  Â  Â  Â  list.className = 'bookmark-list';
Â  Â  Â  Â  items.forEach(item => {
Â  Â  Â  Â  Â  Â  // Favicon alma mantÄ±ÄŸÄ±nÄ± buraya taÅŸÄ±yoruz
Â  Â  Â  Â  Â  Â  let hostname = '';
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  hostname = new URL(item.url).hostname;
Â  Â  Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  Â  Â  // Invalid URL
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  const iconSrc = item.icon || (hostname ? `https://www.google.com/s2/favicons?domain=${hostname}&sz=64` : '');
Â  Â  Â  Â  Â  Â  const fallbackSrc = hostname ? `https://t1.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=http://${hostname}&size=64` : '';
            
Â  Â  Â  Â  Â  Â  // Ä°con iÃ§in HTML yapÄ±sÄ±nÄ±, favicon kaynaklarÄ±nÄ± kullanarak gÃ¼ncelliyoruz.
Â  Â  Â  Â  Â  Â  const iconHtml = iconSrc ? 
Â  Â  Â  Â  Â  Â  Â  Â  `<img src="${iconSrc}" style="width:100%; height:100%; border-radius:inherit; object-fit:cover;" onerror="if(this.src !== '${fallbackSrc}') this.src='${fallbackSrc}'; else this.parentElement.innerHTML = '${item.title.charAt(0).toUpperCase()}'">` 
Â  Â  Â  Â  Â  Â  Â  Â  : item.title.charAt(0).toUpperCase(); // Ne icon ne de hostname varsa baÅŸ harfi gÃ¶ster

Â  Â  Â  Â  Â  Â  list.innerHTML += `
Â  Â  Â  Â  Â  Â  <div class="card" data-id="${item.id}" data-category-id="${cat.id}">
Â  Â  Â  Â  Â  Â  Â  Â  <a href="${item.url}" target="_blank" class="fav" style="background:${cat.color||'#00a3ff'}; color:white; text-decoration:none; display:flex; align-items:center; justify-content:center;">${iconHtml}</a>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="meta">

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <a href="${item.url}" target="_blank" style="text-decoration:none; color:inherit;"><div class="title">${item.title}</div></a>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="url">${item.url}</div>

Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="actions">

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="icon-btn edit-btn">âœï¸</button>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="icon-btn delete-btn">ğŸ—‘ï¸</button>

Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  </div>`;

Â  Â  Â  Â  });

Â  Â  Â  Â  contentArea.appendChild(list);

Â  Â  }



Â  Â  const addBtn = document.createElement('button');

Â  Â  addBtn.textContent = '+ Add Bookmark';

Â  Â  addBtn.className = 'btn';

Â  Â  addBtn.style.marginTop = '20px';

Â  Â  contentArea.appendChild(addBtn);

}



function updateViewButtons() {

Â  Â  $('#listViewBtn').classList.toggle('active', viewMode === 'list');

Â  Â  $('#cardViewBtn').classList.toggle('active', viewMode === 'card');

}



// --- MODAL & DATA MANIPULATION ---

function findBookmark(bookmarkId) {

Â  Â  for (const category of BOOKMARKS) {

Â  Â  Â  Â  const bookmark = (category.items || []).find(item => item.id === bookmarkId);

Â  Â  Â  Â  if (bookmark) return { bookmark, category };

Â  Â  }

Â  Â  return { bookmark: null, category: null };

}



function populateCategorySelect(selectedId = null) {

Â  Â  const select = $('#mCategory');

Â  Â  select.innerHTML = '';

Â  Â  BOOKMARKS.forEach(cat => {

Â  Â  Â  Â  const option = document.createElement('option');

Â  Â  Â  Â  option.value = cat.id;

Â  Â  Â  Â  option.textContent = cat.title;

Â  Â  Â  Â  if (cat.id === selectedId) option.selected = true;

Â  Â  Â  Â  select.appendChild(option);

Â  Â  });

}



function openModalForEdit(bookmarkId, categoryId) {

Â  Â  const { bookmark, category } = findBookmark(bookmarkId);

Â  Â  if (!bookmark) return;



Â  Â  editingState = { bookmarkId, categoryId };

Â  Â  $('#modalTitle').textContent = "Edit Bookmark";

Â  Â  $('#mTitle').value = bookmark.title;

Â  Â  $('#mUrl').value = bookmark.url;

Â  Â  $('#mIcon').value = bookmark.icon || '';

Â  Â  $('#mShowHome').checked = !!bookmark.showHome;

Â  Â  populateCategorySelect(categoryId);

Â  Â  $('#modal').classList.add('active');

}



function openModalForAdd() {

Â  Â  if (currentView === 'home') { alert("Please select a category first."); return; }

Â  Â  editingState = { bookmarkId: null, categoryId: currentView };

Â  Â  $('#modalTitle').textContent = "Add Bookmark";

Â  Â  $('#mTitle').value = ''; $('#mUrl').value = ''; $('#mIcon').value = ''; $('#mShowHome').checked = false;

Â  Â  populateCategorySelect(currentView);

Â  Â  $('#modal').classList.add('active');

}



$('#saveModal').onclick = async () => {

Â  Â  const title = $('#mTitle').value.trim();

Â  Â  let url = $('#mUrl').value.trim();

Â  Â  const newCatId = $('#mCategory').value;

Â  Â  if (!title || !url || !newCatId) return alert("Title, URL, and Category are required.");



Â  Â  // Ensure full URL with protocol

Â  Â  if (!url.match(/^https?:\/\//i)) {

Â  Â  Â  Â  url = 'https://' + url;

Â  Â  }



Â  Â  const bookmarkData = {Â 

Â  Â  Â  Â  title,Â 

Â  Â  Â  Â  url,Â 

Â  Â  Â  Â  icon: $('#mIcon').value.trim() || undefined,Â 

Â  Â  Â  Â  showHome: !!$('#mShowHome').checked

Â  Â  };



Â  Â  const newCat = BOOKMARKS.find(c => c.id === newCatId);

Â  Â  if (!newCat) return alert("Invalid category.");



Â  Â  if (editingState.bookmarkId) { // Editing

Â  Â  Â  Â  const { bookmark, category } = findBookmark(editingState.bookmarkId);

Â  Â  Â  Â  if (bookmark) {

Â  Â  Â  Â  Â  Â  Object.assign(bookmark, bookmarkData);

Â  Â  Â  Â  Â  Â  if (newCatId !== editingState.categoryId) {

Â  Â  Â  Â  Â  Â  Â  Â  // Move to new category

Â  Â  Â  Â  Â  Â  Â  Â  category.items = (category.items || []).filter(i => i.id !== editingState.bookmarkId);

Â  Â  Â  Â  Â  Â  Â  Â  newCat.items = newCat.items || [];

Â  Â  Â  Â  Â  Â  Â  Â  newCat.items.push(bookmark);

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  }

Â  Â  } else { // Adding

Â  Â  Â  Â  newCat.items = newCat.items || [];

Â  Â  Â  Â  newCat.items.push({ id: 'b_' + Date.now(), ...bookmarkData });

Â  Â  }



Â  Â  currentView = newCatId;

Â  Â Â 

Â  Â  $('#modal').classList.remove('active');

Â  Â  editingState = { bookmarkId: null, categoryId: null };

Â  Â  await handleDataChange();

};



function openCategoryEditModal(catId) {

Â  Â  const cat = BOOKMARKS.find(c => c.id === catId);

Â  Â  if (!cat) return;

Â  Â  editingState.categoryId = catId;

Â  Â  $('#ceTitle').value = cat.title;

Â  Â  $('#ceOrder').value = cat.order ?? '';

Â  Â  $('#modalCategoryEdit').classList.add('active');

}



$('#saveCategoryEdit').onclick = () => {

Â  Â  const title = $('#ceTitle').value.trim();

Â  Â  const order = parseInt($('#ceOrder').value) || 0;

Â  Â  if (!title) return alert("Category name is required.");

Â  Â  const catId = editingState.categoryId;

Â  Â  const cat = BOOKMARKS.find(c => c.id === catId);

Â  Â  if (!cat) return;

Â  Â  if (BOOKMARKS.some(c => c.id !== catId && c.title.toLowerCase() === title.toLowerCase())) {

Â  Â  Â  Â  return alert(`Category "${title}" already exists.`);

Â  Â  }

Â  Â  cat.title = title;

Â  Â  cat.order = order;

Â  Â  $('#modalCategoryEdit').classList.remove('active');

Â  Â  editingState.categoryId = null;

Â  Â  handleDataChange();

};



$('#saveCategory').onclick = () => {

Â  Â  const title = $('#cTitle').value.trim();

Â  Â  if (!title) return;

Â  Â  if (BOOKMARKS.some(c => c.title.toLowerCase() === title.toLowerCase())) {

Â  Â  Â  Â  return alert(`Category "${title}" already exists.`);

Â  Â  }

Â  Â  const minOrder = Math.min(...BOOKMARKS.map(c => c.order ?? Infinity)) - 1;

Â  Â  BOOKMARKS.unshift({ id: 'cat_' + Date.now(), title, order: isFinite(minOrder) ? minOrder : 0, color: `#${Math.floor(Math.random()*16777215).toString(16).padStart(6, '0')}`, items: [] });

Â  Â  $('#modalCategory').classList.remove('active');

Â  Â  handleDataChange();

};



// --- EVENT LISTENERS ---

$('#loginBtn').onclick = () => signInWithPopup(auth, new GoogleAuthProvider()).catch(e => console.error("Sign in error", e));

$('#miniSignOutBtn').onclick = () => signOut(auth);

$('#homeBtn').onclick = () => { currentView = 'home'; renderApp(); };

$('#addCategoryBtn').onclick = () => { $('#cTitle').value = ''; $('#modalCategory').classList.add('active'); };



$('#listViewBtn').onclick = () => { viewMode = 'list'; renderApp(); };

$('#cardViewBtn').onclick = () => { viewMode = 'card'; renderApp(); };



$('#categories').addEventListener('click', e => {

Â  Â  const categoryEl = e.target.closest('.category');

Â  Â  if (!categoryEl) return;

Â  Â  const catId = categoryEl.dataset.id;

Â  Â  if (e.target.closest('.edit-cat')) {

Â  Â  Â  Â  openCategoryEditModal(catId);

Â  Â  } else if (e.target.closest('.delete-cat')) {

Â  Â  Â  Â  if (!confirm("Bookmarks will be moved to 'DiÄŸer' category.")) return;

Â  Â  Â  Â  const catToDelete = BOOKMARKS.find(c => c.id === catId);

Â  Â  Â  Â  if (!catToDelete) return;



Â  Â  Â  Â  let otherCat = BOOKMARKS.find(c => c.id === 'cat_other');

Â  Â  Â  Â  if (!otherCat) {

Â  Â  Â  Â  Â  Â  otherCat = { id: 'cat_other', title: 'DiÄŸer', color: '#808080', order: Infinity, items: [] };

Â  Â  Â  Â  Â  Â  BOOKMARKS.push(otherCat);

Â  Â  Â  Â  }

Â  Â  Â  Â  if ((catToDelete.items || []).length > 0) {

Â  Â  Â  Â  Â  Â  otherCat.items = otherCat.items || [];

Â  Â  Â  Â  Â  Â  otherCat.items.push(...catToDelete.items);

Â  Â  Â  Â  }

Â  Â  Â  Â Â 

Â  Â  Â  Â  BOOKMARKS = BOOKMARKS.filter(c => c.id !== catId);

Â  Â  Â  Â  if (currentView === catId) currentView = 'home';

Â  Â  Â  Â  handleDataChange();

Â  Â  } else {

Â  Â  Â  Â  currentView = catId;

Â  Â  Â  Â  renderApp();

Â  Â  }

});



$('#contentArea').addEventListener('click', e => {

Â  Â  const addBtn = e.target.closest('.btn');

Â  Â  if (addBtn && addBtn.textContent.includes('+ Add Bookmark')) return openModalForAdd();

Â  Â Â 

Â  Â  const card = e.target.closest('.card');

Â  Â  if (!card) return;



Â  Â  if (e.target.closest('.edit-btn')) {

Â  Â  Â  Â  openModalForEdit(card.dataset.id, card.dataset.categoryId);

Â  Â  } else if (e.target.closest('.delete-btn')) {

Â  Â  Â  Â  if (!confirm("Are you sure?")) return;

Â  Â  Â  Â  const { category } = findBookmark(card.dataset.id);

Â  Â  Â  Â  if (category) {

Â  Â  Â  Â  Â  Â  category.items = (category.items || []).filter(i => i.id !== card.dataset.id);

Â  Â  Â  Â  }

Â  Â  Â  Â  handleDataChange();

Â  Â  }

});



// Close Modals

$('#cancelModal').onclick = () => $('#modal').classList.remove('active');

$('#cancelCategory').onclick = () => $('#modalCategory').classList.remove('active');

$('#cancelCategoryEdit').onclick = () => $('#modalCategoryEdit').classList.remove('active');

document.addEventListener('keydown', e => {Â 

Â  Â  if (e.key === 'Escape') {

Â  Â  Â  Â  [$('#modal'), $('#modalCategory'), $('#modalCategoryEdit')].forEach(m => m.classList.remove('active'));

Â  Â  }Â 

});



</script>

</body>

</html>
